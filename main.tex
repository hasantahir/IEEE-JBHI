%% bare_jrnl_comsoc.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.




% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/


\documentclass[journal,comsoc]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal,comsoc]{../sty/IEEEtran}

\newcommand\notsotiny{\@setfontsize\notsotiny{6}{7}}
\usepackage[T1]{fontenc}% optional T1 font encoding

% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)

\usepackage{amsmath,amssymb,amsfonts}
% \usepackage{amsfonts} % to load math symbols
\usepackage{commath} % For defining functions
\usepackage{mdwmath}
\RequirePackage{fix-cm} % arbitrary font scaling
\DeclareMathSizes{8}{8}{4}{3}
% \usepackage{showframe}
% \usepackage{mdwtab}
% \usepackage{minipage}
% \usepackage[keeplastbox]{flushend}
\usepackage{graphicx}
% \usepackage{etoolbox}
\usepackage{color}
% \usepackage{placeins}
% \usepackage{subfigure}
\usepackage{subfig}
\usepackage{caption}
\usepackage[nolist]{acronym}
% \usepackage{hyperref}
% % The following is done to hide ugly color boxes around the links
\usepackage[table]{xcolor}
% \hypersetup{
% colorlinks,
% linkcolor={black},
% citecolor={black},
% urlcolor={black}
% }
\usepackage{booktabs}
\usepackage{float}
\usepackage{newtxtext,newtxmath}
% \usepackage{geometry} % just not to bother with the table width
% \usepackage{standalone}
% \usepackage{filecontents}
\usepackage{tabularx,colortbl}
\usepackage{pgfplots}
\usepackage{standalone}
\usepackage{tikz}
\tikzset{
font={\fontsize{11pt}{11}\selectfont}}
\usepackage{tikzscale} % Scale the figure not the font
\pgfplotsset{compat=newest}
\usetikzlibrary{patterns}
%% the following commands are sometimes needed
\usepackage{grffile}
\usepackage{mathtools}
\usepackage[separate-uncertainty = true,
multi-part-units = repeat]{siunitx}
\sisetup{per=slash, load=abbr, output-complex-root = j, complex-root-position = before-number, detect-weight=true, detect-family=true}

% *** CITATION PACKAGES ***
%
% \usepackage{cite}
\usepackage[noadjust]{cite}


% *** GRAPHICS RELATED PACKAGES ***
%
% \usepackage{graphicx}
% declare the path(s) where your graphic files are
\graphicspath{{Figures/}}
%
% Personal definitions
% \renewcommand{\v}[1]{\mathbf{#1}} % vectors
% \newcommand{\ti}[1]{\tilde{#1}} % spectral representation
% \newcommand{\tnsr}[1]{\underline{\underline{#1}}}
% Operators
\renewcommand{\O}{\omega}  % omega
\newcommand{\E}{\varepsilon}  % epsilon
\renewcommand{\u}{\mu}  % mu
\newcommand{\p}{\rho}  % rho
\newcommand{\vp}{\boldsymbol \p}  % rho
\newcommand{\x}{\times}  % times
\renewcommand{\inf}{\infty}  % infinity
\newcommand{\infint}{\int\limits_{-\inf}^\inf} % integral by R
\renewcommand{\del}{\nabla}  % nabla operator
\renewcommand{\^}{\hat}  % unit vector
\newcommand*\diff{\mathop{}\!\mathrm{d}} % Define differential operator
\newcommand{\e}{\mathrm{e}} % Straight-up exponential
\renewcommand{\j}{{j}\mkern1mu} % Straight-up exponential
\newcommand{\iu}{\mathrm{i}\mkern1mu}


% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
%
\title{Support Vector Machine to Predict Type 2 Diabetes using Oral Glucose Tolerance Test}
%
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Hasan~T.~Abbas,~\IEEEmembership{Member,~IEEE,}
Lejla~Alic,~
Madhav~Erraguntla,~
Jim~X.~Ji,~\IEEEmembership{Senior Member,~IEEE,}
Qammer~H.~Abbasi,~\IEEEmembership{Senior Member,~IEEE,}
Muhammad Abdul-Ghani,~
and~Marwa~Qaraqe,~\IEEEmembership{Member,~IEEE}% <-this % stops a space
\thanks{H. T. Abbas and J. X. Ji are with the Department
of Electrical and Computer Engineering, Texas A\&M University at Qatar, Doha 23874 Qatar;  \{hasan.abbas, jim.ji\}@qatar.tamu.edu}% <-this % stops a space
\thanks{L. Alic was with the Department
of Electrical and Computer Engineering, Texas A\&M University at Qatar, Doha 23874 Qatar; lejlaresearch@gmail.com}% <-this % stops a space
\thanks{M. Erraguntla is with the Department of Industrial and Systems Engineering, Texas A\&M University, College Station, TX 77843; merraguntla@tamu.edu}% <-this % stops a space
\thanks{Q. H. Abbasi is with the School of Engineering, University of Glasgow, UK; qammer.abbasi@glasgow.ac.uk}% <-this %
\thanks{M. Abdul-Ghani is with the UT Health, San Antonio, TX 78229; abdulghani@uthscsa.edu}% <-this %
\thanks{M. Qaraqe is with the College of Science and Engineering, Hamad Bin Khalifa University Doha, Qatar; mqaraqe@hbku.edu.qa}% <-this % stops a space stops a space
\thanks{Manuscript received April 19, 2005; revised August 26, 2015.}}

% note the % following the last \IEEEmembership and also \thanks -
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
%
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{Journal of \LaTeX\ Class Files,~Vol.~14, No.~8, August~2015}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Communications Society Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
%
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
  Diabetes is a large healthcare burden worldwide. There is substantial evidence that lifestyle modifications and drug intervention can prevent diabetes, therefore, an early identification of high risk individuals is important to design targeted prevention strategies. In this paper, we present an automatic tool that uses machine learning techniques to predict the development of type 2 diabetes mellitus (T2DM). Data generated from an oral glucose tolerance test (OGTT) was used to develop a predictive model based on the support vector machine (SVM). We trained and validated the models using the OGTT and demographic data of \num[group-minimum-digits=4, group-separator = {,}]{1492} healthy individuals collected during the San Antonio Heart Study. This study collected plasma glucose and insulin concentrations before glucose intake and at three time-points thereafter (\num{30}, \num{60} and \SI{120}{\minute}). Furthermore, personal information as age, ethnicity and body-mass index was also a part of the dataset. Using \num{11} \ac{ogtt} measurements, we have deduced 61 features, which are then assign a rank and the top ten features are shortlisted using Minimum Redundancy Maximum Relevance feature selection algorithm. All possible combinations of the \num{10} best ranked features were used to generate SVM based prediction models.  This research shows that an individual's abnormal plasma glucose levels, and the information derived therefrom have the strongest predictive performance for the future development of T2DM. Significantly, insulin and demographic features do not provide additional performance improvement for diabetes prediction. The results of this work identify the parsimonious clinical data needed to be collected for an efficient prediction of T2DM. Our approach shows an average accuracy of \SI{96.80}{\percent} and a specificity of \SI{80.09}{\percent} obtained on a holdout set.
\end{abstract}


%
% Note that keywords are not normally used for peer-review papers.
\begin{IEEEkeywords}
  Type 2 Diabetes prediction, machine learning, disease risk assessment, San Antonio heart study.
\end{IEEEkeywords}
%
% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle
%
%
%
\section{Introduction}
% The very first letter is a 2 line initial drop letter followed
% by the rest of the first word in caps.
%
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
%
% form to use if you need the single drop letter followed by
% normal text (unknown if ever used by the IEEE):
% \IEEEPARstart{A}{}demo file is ....
%
% Some journals put the first two words in caps:
% \IEEEP\citeARstart{T}{his demo} file is ....
%
% Here we have the typical use of a "T" for an initial drop letter
% and "HIS" in caps to complete the first word.
\IEEEPARstart{T}{he} global incidence of diabetes was estimated at \num{422} million in the year \num{2014} and its prevalence among the adult population increased from \SI{4.7}{\percent} in \num{1980} to \SI{8.5}{\percent} in \num{2014} \cite{mathers_projections_2006}. In \num{2015} alone, about \num{1.6} million deaths worldwide were attributed to diabetes. In addition to the high mortality rate, an individual with diabetes is at a greater risk of developing \ac{cvd}, visual impairment and limb amputations, as compared to a non-diabetic individual. Due to the substantial socio-economic burdens that are associated with diabetes, its early detection, prevention, and management has become a worldwide top-level health concern. There is experimental evidence that the development of diabetes can be delayed or even prevented provided an individual undertakes a lifestyle change that includes diet management, adopting exercise, and adhering to a pharmacological treatment \cite{tuomilehto2001prevention}. The early identification of high risk individuals of diabetes is therefore, essential for targeted prevention strategies \cite{diabetes2015long}.

Even though the number of clinical studies aimed at diagnosing diabetes has been growing recently, studies predicting the risk of developing diabetes are limited. This subject has lately received an increased amount of research interest \cite{noble2011risk}. However, the clinical significance of such predictions largely depend on the type and quality of data collected. There are studies that assign a probability to the future risk of diabetes using socio-demographic characteristics such as age, ethnicity, \ac{bmi} and genealogical information collected through population  \cite{Heikes1040, Glumer727}. Due to the unreliable data collection, such techniques can be misleading. The collection of blood samples, on the other hand, provides more reliable data and is a first step towards the disease prognosis with a deeper clinical insight \cite{HELIOVAARA1993181}. The \ac{ogtt} is commonly used to screen diabetes \cite{expert-committee} and to provide a critical understanding of its future evolution \cite{stumvoll_use_2000}. In an \ac{ogtt}, the plasma glucose and insulin levels are measured at regular intervals in a 2-hr period after orally administering a standard dose of glucose \cite{stumvoll_use_2000}. The glucose tolerance and insulin resistance are two of the most significant parameters deduced from the \ac{ogtt} that are widely regarded as the major factors in the development of \ac{t2dm}.

A precursory stage of diabetes, commonly referred to as prediabetes, exists before overt \ac{t2dm}, and is described by \ac{ifg}, along with \ac{igt}. According to the \ac{who} diagnostic criteria, the \ac{ifg} is defined as fasting plasma glucose level of \SIrange[round-mode = off,group-separator = {,}]{100}{125}{\milli\gram\per\deci\liter}. The \ac{igt} which describes an abnormally raised glucose level is defined as the 2-hour plasma glucose level in the range of \SIrange[round-mode = off,group-separator = {,}]{140}{199}{\milli\gram\per\deci\liter}, measured during the \ac{ogtt} \cite{organization_definition_2006}. Although prediabetes is considered as an intermediate stage in the natural progression of \ac{t2dm} \cite{defronzo2011assessment}, it has been reported that only \SI{50}{\percent} of the subjects diagnosed with \ac{igt} developed diabetes within 10 years \cite{shaw_impaired_1999, writing_committee_impaired_2002}. Moreover, long-term population studies have also shown that around \SI{50}{\percent} of the diabetic patients did not exhibit \ac{igt} at any time prior to the diagnosis \cite{abdul-ghani_what_2007}. This suggests that the fasting and 2-hour plasma glucose levels used in and of themselves cannot accurately predict the future development of \ac{t2dm}.
%
\begin{figure*}
  \centering
  \subfloat[Plasma Glucose]
  {
  \includegraphics[width=.45\textwidth]{boxpl_glucose.tikz}
  \label{fig:glucose}
  }
  \subfloat[Serum Insulin]
  {
  \includegraphics[width=.45\textwidth]{boxpl_Insulin.tikz}
  \label{fig:insulin}
  }
  \caption{Box plots of glucose and insulin levels for healthy and diabetic subjects measured at the baseline \ac{ogtt}.}
  \label{fig:ogtt_mean}
\end{figure*}
%

\ac{ml} has been proposed as a viable instrument for diabetes screening. In contrast to traditional diagnostic techniques employing population based statistics, \ac{ml} methods develop models that are trained using large amounts of data. Barakat et al used socio-demographic information, and point-of-care testing from blood and urine to develop diagnostic models of diabetes \cite{barakat_intelligible_2010}. This approach uses \ac{svm} along with a rule-based explanation to provide a comprehensibility of the results to the clinicians. The plasma glucose levels at baseline and 2-hr were among the features used. Han et al employed an ensemble \ac{svm} and random forest learning approaches to develop a decision making algorithm for the diagnosis of diabetes \cite{han_rule_2015}. However, investigations that are designed to identify individuals at high risk of developing \ac{t2dm} in the future are limited. The \ac{sadpm} \cite{stern2002identification} uses a logistic regression supported by physiological parameters such as systolic blood pressure and cholesterol level. The underlying causes of \ac{t2dm} in the form insulin resistance and insulin secretion were studied to develop a prediction model in \cite{abdul-ghani_what_2007}. In another study, multivariate logistic models using the plasma glucose values measured in the \ac{ogtt} were used to predict the future risk of developing \ac{t2dm} \cite{abdul-ghani_two-step_2011,abdul2009fasting}. The predictive power of different biomarkers such as the fasting plasma glucose level, \ac{bmi} and hemoglobin A1C (HbA1c) for \ac{t2dm} onset was assessed in \cite{Ozery-Flato2013}. This study focused on individuals with metabolic syndrome, a complex and serious health condition that greatly increases the risk of \ac{cvd} and diabetes.

The standard \ac{ml} algorithms are designed to yield optimal performance in terms of accuracy over the full dataset. However, medical applications such as diagnosis and prediction of a disease require a biased decision-making mechanism that favors one of the classes. This approach inherently maximizes the performance of the class that is more relevant in clinic terms. Therefore, the objective in such applications is to design a classifier that improves the accuracy of the class that is clinically more relevant. Additionally, often the amount of data is highly skewed with the clinically relevant class in an outsized minority. There are various roundabout ways to obtain accurate classifier performance in this scenario that include the method of sampling \cite{chawla2002smote} in which the class distribution is artificially balanced by either under sampling the majority class, over-sampling the minority class or both. Furthermore, feature weighting schemes assign distinct costs to training examples \cite{Domingos} in order to introduce a certain bias. Other techniques introduce evaluation metric such as the \ac{gm} \cite{kubat1997addressing}, that concurrently optimizes the positive class accuracy (sensitivity) and the negative class accuracy (specificity) \cite{Tang_SVM}.

We hypothesized that the features extracted from the \ac{ogtt} will be able to predict the future onset of \ac{t2dm}. In this paper, we therefore propose a screening tool that identifies the most relevant features extracted from the \ac{ogtt} data that strongly correlate with the future development of \ac{t2dm}. We then use \ac{svm} to develop a prediction model by utilizing these relevant features estimated from the longitudinal cohort study, the \ac{sahs} \cite{burke_rapid_1999,lorenzo_trend_2006}.
%
\section{Materials and Methods}
%
\subsection{San Antonio Heart Study}
%
The SAHS is a population-based epidemiological study that was conducted to assess the risk factors of diabetes and cardiovascular diseases in healthy population \cite{burke_rapid_1999,lorenzo_trend_2006}. In total, \num[group-minimum-digits=4, group-separator = {,}]{5158} men and non-pregnant women of \ac{ma} and \ac{nhw} residents of San Antonio, Texas participated in the study in two cohorts. The age of individuals at the time of recruitment was between \num{25} and \num{64} years. As a part of the data collection, plasma glucose and serum insulin concentrations were collected during the \ac{ogtt} at the baseline and after an average follow-up of \num{7.5} years. The \ac{bmi} was also recorded for each individual at the baseline. In this study, we analyzed only the data generated from the second cohort of the \ac{sahs} which comprised of \num[group-minimum-digits=4, group-separator = {,}]{1492} subjects from the second cohort of the SAHS.

\ac{t2dm} was diagnosed at the follow-up using the \ac{who} criteria, i.e. fasting glucose level \SI[round-mode = off,group-separator = {,}]{> 126}{\milli\gram\per\deci\liter} or 2-hr glucose level \SI[round-mode = off,group-separator = {,}]{\ge 200}{\milli\gram\per\deci\liter} \cite{organization_definition_2006}. Furthermore, all individuals taking anti-diabetic medications were also classified as having \ac{t2dm}. Individuals that reported by themselves any cardiovascular event such as a heart attack, stroke or angina, were labeled as having \ac{cvd} at the follow-up. All other participants without \ac{t2dm} or self-reported \ac{cvd} were labeled as healthy for the case of this study. During the course of this longitudinal study, a total of \num{171} individuals developed \ac{t2dm} with \num{10} individuals also reporting at least one cardiovascular event. The incidence rate of \ac{t2dm} in the second cohort of the \ac{sahs} population was \SI{10.79}{\percent}. Table \ref{tab:patients} shows the population distribution in terms of the four classes. The distribution in terms of the ethnicity shows the \ac{t2dm} prevalence among the \ac{ma} individuals more than double, as compared to the \ac{nhw} population.
%
\begin{table}[!b]
  \centering
  \renewcommand{\arraystretch}{1.3}
  \caption{The classification of the \num[group-minimum-digits=4, group-separator = {,}]{1492} subjects used in this study based on the ethnicity.}
  % \vspace{-4mm}%Put here to reduce too much white space after table
  \centering
  \begin{tabular}{c c c c c}
    \toprule
    & Healthy &  \ac{t2dm} & \ac{cvd} & \ac{t2dm}+\ac{cvd}\\
    \midrule \midrule
    Total & \num[group-minimum-digits=4, group-separator = {,}]{1277} & \num{161} & \num{44} & \num{10}\\
    &\SI{85.56}{\percent} & \SI{10.79}{\percent} & \SI[round-precision=3]{2.95}{\percent} & \SI[round-precision=2]{0.67}{\percent} \\
    \midrule
    \ac{ma} & \num[group-minimum-digits=4, group-separator = {,}]{836} & \num{131} & \num{24} & \num{7}\\
    &\SI{83.77}{\percent} & \SI{13.13}{\percent} & \SI[round-precision=3]{2.40}{\percent} & \SI[round-precision=2]{0.70}{\percent} \\
    \midrule
    \ac{nhw} & \num[group-minimum-digits=4, group-separator = {,}]{441} & \num{30} & \num{20} & \num{3}\\
    &\SI{89.27}{\percent} & \SI{6.07}{\percent} & \SI[round-precision=3]{4.05}{\percent} & \SI[round-precision=2]{0.61}{\percent} \\
    \bottomrule
  \end{tabular}
  \label{tab:patients}
\end{table}
%

The data used in this study consists of plasma glucose and serum insulin concentrations sampled at the baseline, and at \num{30}, \num{60} and \SI{120}{\minute} thereafter. The individuals are labeled at the SAHS follow-up using the current standard of care \cite{burke_rapid_1999}. Figure \ref{fig:ogtt_mean} shows the distributions of the data used in this study.
%
%
\subsection{Machine Learning Framework}
%
In this paper, we implemented \ac{svm} to construct the models for the prediction of future \ac{t2dm}. The \ac{svm} develops models from a given training dataset such that it generalizes well to a new dataset and minimizes the empirical risk associated with misclassification of samples in the training set \cite{vapnik_nature_2000,vapnik2015uniform}. A model constructed by the \ac{svm} minimizes the overlap between classes in the training set by optimizing the separating hyperplane. For problems that may not be amenable to linear separation between the two classes, the \ac{svm} technique is very attractive due to the fact that the input feature space can be transformed to a higher dimension space,  and a linear boundary can then be determined. This approach generally provides a better training performance, but potentially increases computational complexity excessively with the increase of the dimensionality of the input feature space \cite{friedman2001elements}. The introduction of a kernel alleviates the need to determine the transformation by calculating the inner product between the coordinates of the input feature space instead. In this paper, we used the Gaussian \ac{rbf}, as the kernel. The performance of the \ac{svm} can be optimized by tuning the free parameter of the kernel $\sigma$ and specifying a cost that controls the rigidity of the class margin. This process is normally carried out through a grid search.
%
%
%
%
\subsection{Feature Extraction}
%
We extracted all the features from the \ac{sahs} data acquired at the baseline. The dataset consists of plasma glucose and insulin concentrations recorded before glucose intake and at three time-points thereafter (\num{30}, \num{60}, and \SI{120}{\minute}). The labels (healthy and diabetes) were generated at the \num{7.5} years follow-up using the current standard of care diagnostics \cite{burke_rapid_1999}. From the glucose and insulin concentrations, we computed the slope and area under the curve between all the possible combinations of a pair of measurements. In addition, we also calculated three empirical markers that describe the relationship between the glucose intake and insulin response. The first is the \ac{igi} \cite{seino1975insulinogenic}, which is a direct measure of the insulin response to glucose. It is calculated as the ratio of the slope of the insulin curve to the slope of the glucose curve between any two time intervals in the \ac{ogtt}. The second marker, \ac{mi} evaluates the insulin sensitivity from the \ac{ogtt} using a product of the weighted averages of the glucose and insulin concentrations \cite{Matsuda1462},
%
\begin{equation}
  \begin{split}
    \mathrm{M} = \frac{10,000}{8\sqrt{\mathrm{G}_0 \cdot \mathrm{I}_0}}
     \big[{\mathrm{G}_0+2\mathrm{G}_{30}+2\mathrm{G}_{60}+2\mathrm{G}_{90}+ \mathrm{G}_{120}}\big]^{-1/2}\\
      \times \big[{\mathrm{I}_0+2\mathrm{I}_{30}+2\mathrm{I}_{60}+2\mathrm{I}_{90}+\mathrm{I}_{120}} \big]^{-1/2}
  \end{split}
  \label{eq:mat_idx}
\end{equation}
%
% \begin{align}
%   \mathrm{M} = \dfrac{10,000}{\sqrt{\mathrm{Glu}_0 \times \mathrm{Ins}_0 \times \dfrac{15~ \mathrm{Glu}_0 + 30 \mathrm{Glu}_{30} + 30~ \mathrm{Glu}_{60} + 30~ \mathrm{Glu}_{90} + 15~ \mathrm{Glu}_{120}}{120} \times \dfrac{15~ \mathrm{Ins}_0 + 30~ \mathrm{Ins}_{30} + 30~ \mathrm{Ins}_{60} + 30~ \mathrm{Ins}_{90} + 15~ \mathrm{Ins}_{120}}{120}}},
%   \label{eq:mat_idx}
% \end{align}
%
where the subscripts depict the time point of the \ac{ogtt}. In case when the value at \SI{90}{\minute} is not available, the average of \num{60} and \SI{90}{\minute} is used instead \cite{Matsuda1462}. The third marker, \ac{homair} \cite{matthews1985homeostasis} evaluates the beta-cell function. It is defined as the product of fasting plasma glucose concentration and fasting blood insulin concentration divided by \num{22.5}. These markers have been used to estimate abnormalities in the insulin sensitivity. A total of \num{61} features (illustrated in Fig. \ref{fig:features}) are used in this study. The prefix AuC denotes the area under the curve and the slope is denoted by the symbol $\Delta$. The term T\textsubscript{half} represents the linearly interpolated value between any two intervals.
%
\begin{figure*}[t!]
  \centering
  \includegraphics[width=.95\linewidth]{features_define_text.pdf}
  \caption{Illustration of all \num{61} features extracted from the \ac{sahs} dataset.}
  \label{fig:features}
\end{figure*}
%
%
%
%
\subsection{Feature Selection}
%
Before constructing the \ac{svm} model to predict a future diabetes occurrence, we search for the most effective subset of features in terms of relevance to the classifier output, i.e. incidence of \ac{t2dm} at the follow-up. As a first step, we selected the ten most relevant features from the \num{61} available features using the \ac{mrmr} algorithm \cite{mRMR}, which selects the most relevant features with minimum correlation among them. The \ac{mrmr} algorithm determines the relevance between a feature ($x$ as continuous random variable) and the class label ($y$ as discrete random variable) in terms of the mutual information $\mathcal I$ defined as \cite{ross2014mutual},
%
\begin{equation}
  \mathcal I(x, y) = - \int p_i \ln p_i \diff x - \sum \limits_j p_j\ln p_j + \sum_j \int p_{ij}\ln p_{ij} \diff x,
  \label{eq:MI}
\end{equation}
%
where $p_{i}$, and $p_{j}$ are the probabilities of the random variables $x$ and $y$ taking a particular value $x_i$ and $y_j \in (-1,1) \, \forall j$ respectively. The term $p_{ij}$ denotes the joint probability $P\{x= x_i, y=y_j\}$. The three terms in \eqref{eq:MI} represent the continuous, discrete and joint entropies of the random variables in the respective order. The features that are most relevant to the class label are the ones that maximize $\mathcal I$. A heuristic approach is to keep only one a single feature from a correlated set of features that provides similar relevance information, and discard the remaining features. In order to ensure this, the \ac{mrmr} algorithm minimizes the mutual correlation among the features expressed in terms of redundancy $\mathcal R$,
%
\begin{equation}
  \mathcal R(\mathbb X) = \sum \limits_{x_i, x_j \in \mathbb{X}} \mathcal {I}(x_i, x_j).
  \label{eq:R}
\end{equation}
%
where $\mathcal I$ follows its definition in \eqref{eq:MI}. This procedure yielding maximum $\mathcal I$ with respect to the diabetic class, along with minimal $\mathcal R$, shortlists a set of ten features that are potentially strong predictors of the future development of \ac{t2dm}.
%
%
%
\begin{table}[b!]
  \centering
  \renewcommand{\arraystretch}{1.3}
  \caption{List of ten most relevant features ranked by the \ac{mrmr} algorithm}
  % \vspace{-4mm}%Put here to reduce too much white space after table
  \centering
  \begin{tabular}{c c}
    \toprule
    Rank &  Feature\\
    \midrule \midrule
    1 & AuC-G\textsubscript{0-120}\\
    2 & $\Delta$G\textsubscript{120-0}\\
    3 & $\Delta$G\textsubscript{120-60}\\
    4 & Ethnicity \\
    5 & $\Delta$I\textsubscript{120-0}\\
    6 & $\Delta$G\textsubscript{60-0}\\
    7 & $\Delta$G\textsubscript{30-0}\\
    8 & $\Delta$G\textsubscript{60-30}\\
    9 & $\Delta$I\textsubscript{120-60}\\
    10 & $\Delta$I\textsubscript{60-0}\\
    \bottomrule
  \end{tabular}
  \label{tab:ranked}
  % \vspace{4mm}%Put here to reduce too much white space after table
\end{table}
%
%
\subsection{Classification}
%
We developed a supervised learning scheme using the baseline \ac{sahs} dataset and the labels (healthy, \ac{t2dm}) obtained at the follow-up after an average of \num{7.5} years. In each experiment, we used a kernel-based binary \ac{svm} method to train, test and validate the performance of the diabetes prediction models.  We excluded the \num{44} \ac{cvd} entries as the only way of defining this class was based upon self-reporting and not on quantitative assessment. Furthermore, we also removed all entries with any information missing. That resulted in a total of \num[group-minimum-digits=4, group-separator = {,}]{1492} instances that were used in this study, out of which \num{171} were from the minority class and \num[group-minimum-digits=4, group-separator = {,}]{1321} were majority instances. As shown in Table \ref{tab:patients}, the \ac{sahs} dataset is intrinsically unbalanced with the class distribution skewed toward the majority class with a ratio of 7.5:1. We considered the minority class of diabetic subjects as the positive class with a label of 1, whereas the majority class consisting of healthy persons was termed as the negative class marked by a `-1' label. To standardize the feature range prior to training, the feature space was scaled to unit variance around the respective mean for each feature respectively. To ensure that a model was unbiased, robust, and generalized well to the new data, we performed 10-fold \ac{cv}.

\begin{figure*}[t!]
  \centering
  \subfloat[Linear]
  {
  \includegraphics[width=0.45\textwidth]{gmean_lin_unbal_xbar.tikz}
  \label{fig:gmean_lin_unbal}
  }
  \subfloat[\ac{rbf}]
  {
  \includegraphics[width=0.45\textwidth]{gmean_rbf_unbal_xbar.tikz}
  \label{fig:gmean_rbf_unbal}
  }
  \caption{The \ac{gm} of sensitivity and specificity for (a) linear, and (b) \ac{rbf} kernels. The maximum performance feature combination is depicted by a different color scheme.}
  \label{fig:gmean}
\end{figure*}
%
For each \ac{cv}, we first randomly selected a hold-out set consisting of \num{11} minority and \num{83} majority instances. We evaluated each model \num{100} times, in which the data was randomly partitioned on each occasion. We compared the performances of linear and non-linear \ac{svm} for all \num[group-minimum-digits=4, group-separator = {,}]{1023} possible combinations of ten most relevant features by increasing the number of features incrementally from one to ten. The optimal hyperplane parameters of the kernel were determined through a grid search. To select the best feature set, we have used the geometric mean of specificity and sensitivity \cite{kubat1997addressing}. All experiments were performed by an in-house developed software using Matlab\textregistered (version 9.2.0 MathWorks Inc., Natick, Massachusetts, USA).
%
%

%
\section{Results and Discussion}
%
%
The \ac{mrmr} algorithm produces a sequential list of ten ranked features, shown in Table \ref{tab:ranked}. Besides ethnicity (ranked fourth), all other features are notably derived from \ac{ogtt} measurements. The list contains six features derived from plasma glucose concentrations, while only three features are deduced from insulin concentrations.
%
\begin{figure}[h!]
  \centering
  \subfloat[Linear]
  {
  \includegraphics[width=0.45\textwidth]{sn_acc_lin_unbal.tikz}
  \label{fig:sn_acc_lin_unbal}
  } \\
  \subfloat[\ac{rbf}]
  {
  \includegraphics[width=0.45\textwidth]{sn_acc_rbf_unbal.tikz}
  \label{fig:sn_acc_rbf_unbal}
  }
  \caption{The classifier performance in terms of accuracy and sensitivity for the best feature combinations.}
  \label{fig:sn_acc}
\end{figure}

In all the classification experiments, we aimed to maximize the ability to correctly predict the diabetic class without compromising the classifier accuracy. The bar plots in Fig. \ref{fig:gmean} show the \ac{gm} of the sensitivity and specificity obtained from the linear and \ac{rbf} kernels. For each number of features used, we selected the combination that generated the maximum \ac{gm}. All the results presented here are averaged over \num{100} iterations of the respective classifiers. The \ac{gm} obtained from the linear \ac{svm} ranges from \num{0.8711} to \num{0.8742}. As observed from Fig. \ref{fig:gmean_lin_unbal}, the addition of more features does not result in a substantial performance improvement. However, the maximum \ac{gm} of the sensitivity and specificity is obtained when all \num{10} features are used. For the non-linear \ac{svm} with \ac{rbf} kernel, the \ac{gm} ranges from \num{0.8638} to \num{0.8903}. The combination of the features namely, AuC-Glu\textsubscript{0-120}, $\Delta$G\textsubscript{120-0}, $\Delta$G\textsubscript{120-60} and $\Delta$G\textsubscript{30-0} yields the maximum performance. Notably, all four features are derived from the plasma glucose concentrations. We note that the glucose derived features are ranked the highest during feature selection. Moreover, a combination of glucose only features generate the best \ac{svm} models when less than four features are used.

\begin{table*}[t!]
  \centering
  \renewcommand{\arraystretch}{1.3}
  \caption{Comparison of validation performance of the best \ac{svm} classifiers with previous studies.}
  \centering
  \begin{tabularx}{.75\linewidth}{c c c c c}
    \toprule
    &  Accuracy \textpm ~SD & Specificity \textpm ~SD & Specificity \textpm ~SD & \ac{gm} \textpm ~SD\\
    \midrule \midrule
    Linear SVM (10 features) & \SI{95.55 \pm 0.24}{\percent} & \SI{78.09 \pm 0.33 }{\percent}  & \SI{97.87 \pm 0.3}{\percent} & \num{0.8742 \pm 0.21}\\
    \ac{svm}-\ac{rbf} (4 features) & \SI{96.80 \pm 0.41}{\percent} & \SI{80.09 \pm 1.42}{\percent}  & \SI{99.02 \pm 0.33}{\percent} & \textbf{\num{0.8903 \pm 1.56}}\\
    \ac{sadpm} \cite{stern2002identification} & \SI{56.329}{\percent} & \SI{88.80}{\percent} & \SI{52.00}{\percent} & \num{.6795}\\
    Two-step Approach \cite{abdul-ghani_two-step_2011} & \SI{77.43}{\percent} & \SI{77.70}{\percent} & \SI{77.40}{\percent} & \num{0.7755}\\
    \bottomrule
  \end{tabularx}
  \label{tab:validation}
  % \vspace{-8mm}%Put here to reduce too much white space after table
\end{table*}
%
The accuracy and sensitivity of the same feature combinations are separately shown in Fig. \ref{fig:sn_acc}. The best model obtained using a combination of four glucose derived features and \ac{rbf} kernel has an accuracy of \SI{96.80}{\percent}, and sensitivity of \SI{80.09}{\percent}. It is worth mentioning that during all our classification experiments, maximum sensitivity of \SI{81.27}{\percent} was obtained using only one ethnicity feature. However, the accuracy dropped to \SI{41.33}{\percent}.

Table \ref{tab:validation} presents a comparison of the generated \ac{svm} models to the results obtained in other studies using the \ac{sahs} dataset. We compared our results with the \ac{sadpm} \cite{stern2002identification}, in which a person's age, gender, ethnicity, fasting glucose level, family history, blood pressure, and cholesterol level were used to construct a logistic regression. It is notable that the \ac{sadpm} has the highest  sensitivity (\SI{88.80}{\percent}) however, the increased prediction performance comes along with a very low accuracy of \SI{56.33}{\percent}. In \cite{abdul-ghani_two-step_2011}, a two-step approach was introduced that first used the \ac{sadpm} risk score and then augmented it with the 1-hour plasma glucose concentration measured in the \ac{ogtt}. This strategy resulted in an improved accuracy but the sensitivity dropped to \SI{77.70}{\percent}.

In the \ac{sahs} dataset, the prevalence of \ac{ifg} and \ac{igt} was \SI{8.91}{\percent} (\num{133} instances) and \SI{22.52}{\percent} (\num{336} instances) respectively. Out of the \num{399} subjects diagnosed with prediabetes showing \ac{ifg} or \ac{igt} at the baseline, only \num{120} (\SI{30.08}{\percent}) actually developed diabetes between the baseline and the follow-up. Furthermore, \num{120} (\SI{25.67}{\percent}) subjects diagnosed with diabetes at the follow-up did not show any symptoms of either \ac{igt} or \ac{ifg} at the baseline.

Our investigation shows that features derived from insulin have less predictive value for \ac{t2dm} as compared to glucose based features. Indices such as Matsuda and \ac{homair} that are commonly used to assess the insulin function, also did not yield high correlation with the future development of \ac{t2dm}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\section{Conclusion}
%
%
In this paper, we present a most promising set of features that are used to develop a non-linear \ac{svm} based future \ac{t2dm} prediction model. The features were derived from the \ac{ogtt} data and were augmented by personal information such as age, ethnicity, and \ac{bmi}. Using a feature selection algorithm, we demonstrate that the features deduced from the plasma glucose concentrations provide the optimal feature subset and have the strongest predictive power for the future development of \ac{t2dm}. Moreover, the performance of the presented prediction model is significantly better in terms of accuracy and sensitivity combined, as compared to other \ac{t2dm} prediction schemes. In order to address the unbalanced nature of the \ac{sahs} dataset, we chose the \ac{gm} of sensitivity and specificity as the performance evaluation criteria.

The principal contribution of this study includes a \ac{t2dm} prediction model based on the features derived only from the plasma glucose concentrations measured during an \ac{ogtt}. The findings of this paper provide a complementary and cost-effective tool for the clinicians to screen individuals that are at an increased risk of developing \ac{t2dm} in the future.
%
%
%
%
\section*{Acknowledgment}
%
This publication was made possible by NPRP grant number NPRP 10-1231-160071 from the Qatar National Research Fund (a member of Qatar Foundation). The statements made herein are solely the responsibility of the authors.
%
%
% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
\newpage
\fi
% \balance
\bibliographystyle{IEEEtran}
% \bibliographystyle{ieeetr}
% \atColsEnd{\vfil}
% argument is your BibTeX string definitions and bibliography database(s)
\bibliography{References_clean}
%
%
\begin{IEEEbiography}{Michael Shell}
  Biography text here.
\end{IEEEbiography}
%
% if you will not have a photo at all:
\begin{IEEEbiographynophoto}{John Doe}
  Biography text here.
\end{IEEEbiographynophoto}
%
% insert where needed to balance the two columns on the last page with
% biographies
%\newpage
%
\begin{IEEEbiographynophoto}{Jane Doe}
  Biography text here.
\end{IEEEbiographynophoto}
%
% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}
\input{./acronym.tex}


% that's all folks
\end{document}
